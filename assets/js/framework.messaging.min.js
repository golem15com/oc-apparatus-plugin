$(function(){'use strict'
if(!$.apparatus){$.apparatus={}}
var defaults={noty:{layout:'top',theme:'bootstrapTheme',type:'alert',text:'',dismissQueue:true,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',timeout:false,force:false,modal:false,maxVisible:5,killer:false,closeWith:['click'],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:false}}
var Messaging=function(){var self=this
var configEl=$('[data-messaging-config]')
if(configEl.length){configEl=configEl.first()}
var config=this.makeConfig(configEl)
this.config=$.extend(true,{},defaults,config)
$(window).on('ajaxErrorMessage',function(event,message){event.preventDefault()
self.handleMessage({type:'error',text:message})})}
Messaging.prototype.handleMessage=function(options){console.log(this.config.noty);new Noty($.extend(true,{},this.config.noty,options)).show()}
Messaging.prototype.handleFlashMessage=function(type,message){this.handleMessage({type:this.parseFlashMessageType(type),text:message})}
Messaging.prototype.parseFlashMessageType=function(flashMessageType){switch(flashMessageType){case 'info':return 'information'
break
default:return flashMessageType
break}}
Messaging.prototype.makeConfig=function(configEl){if(!configEl.data){return{}}
return{noty:{layout:configEl.data('msgLayout')?configEl.data('msgLayout'):defaults.noty.layout,theme:configEl.data('msgTheme')?configEl.data('msgTheme'):defaults.noty.theme,dismissQueue:configEl.data('msgDismissQueue'),template:configEl.data('msgTemplate')?configEl.data('msgTemplate'):defaults.noty.template,animation:{open:configEl.data('msgAnimationOpen')?configEl.data('msgAnimationOpen'):defaults.noty.animation.open,close:configEl.data('msgAnimationClose')?configEl.data('msgAnimationClose'):defaults.noty.animation.close},timeout:configEl.data('msgTimeout')?configEl.data('msgTimeout'):defaults.noty.timeout,force:configEl.data('msgForce')?configEl.data('msgForce'):defaults.noty.force,modal:configEl.data('msgModal')?configEl.data('msgModal'):defaults.noty.modal,maxVisible:configEl.data('msgMaxVisible')?configEl.data('msgMaxVisible'):defaults.noty.maxVisible}}}
$.apparatus.messaging=new Messaging()})